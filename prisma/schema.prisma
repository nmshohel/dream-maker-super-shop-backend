generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id              String            @id @default(uuid())
  name            String
  email           String            @unique
  password        String
  role            UserRole
  contactNo       String
  address         String
  shippingAddress String
  profileImg      String
  reviewAndRating ReviewAndRating[]
  Order           Order[]
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt

  @@map("users")
}

model ProductType {
  id        String     @id @default(uuid())
  title     String
  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  categorys Category[]
  products  Product[]

  @@map("product_type")
}

model Category {
  id            String        @id @default(uuid())
  title         String
  productTypeId String
  productType   ProductType   @relation(fields: [productTypeId], references: [id])
  products      Product[]
  createdAt     DateTime      @default(now())
  updatedAt     DateTime      @updatedAt
  subCategorys  SubCategory[]

  @@map("categories")
}

model SubCategory {
  id         String    @id @default(uuid())
  title      String
  categoryId String
  category   Category  @relation(fields: [categoryId], references: [id])
  products   Product[]
  createdAt  DateTime  @default(now())
  updatedAt  DateTime  @updatedAt

  @@map("sub_categories")
}

model Brand {
  id        String    @id @default(uuid())
  title     String
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
  products  Product[]

  @@map("brand")
}

model Product {
  id              String            @id @default(uuid())
  title           String
  price           String
  discount        String?
  description     String?
  brandId         String?
  brand           Brand?            @relation(fields: [brandId], references: [id])
  warranty        String?
  productCode     String?
  quantity        String
  thumbImage      String[]
  images          String[]
  slug            String
  rate            String
  reviewCount     String?
  new             Boolean           @default(true)
  productTypeId   String
  productType     ProductType       @relation(fields: [productTypeId], references: [id])
  subCategoryId   String
  subCategorys    SubCategory       @relation(fields: [subCategoryId], references: [id])
  categoryId      String
  categorys       Category          @relation(fields: [categoryId], references: [id])
  ReviewAndRating ReviewAndRating[]
  createdAt       DateTime          @default(now())
  updatedAt       DateTime          @updatedAt
  orderedProducts OrderedProduct[]

  @@map("products")
}

model ReviewAndRating {
  id        String   @id @default(uuid())
  review    String
  userId    String
  user      User     @relation(fields: [userId], references: [id])
  productId String
  product   Product  @relation(fields: [productId], references: [id])
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("review")
}

model Order {
  id             String           @id @default(uuid())
  userEmail      String
  user           User             @relation(fields: [userEmail], references: [email])
  status         Status           @default(pending)
  orderType      OrderType        @default(cashOnDelivery)
  createdAt      DateTime         @default(now())
  updatedAt      DateTime         @updatedAt
  OrderedProduct OrderedProduct[]

  @@map("orders")
}

model OrderedProduct {
  id        String   @id @default(uuid())
  orderId   String
  order     Order    @relation(fields: [orderId], references: [id])
  productId String
  product   Product  @relation(fields: [productId], references: [id])
  quantity  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("ordered_books")
}

model Payment {
  id                 String        @id @default(uuid())
  amount             Int
  userEmail          String?
  status             PaymentStatus @default(PANDING)
  transactionId      String
  paymentGatewayData Json?
  createdAt          DateTime?     @default(now())
  updatedAt          DateTime?     @updatedAt

  @@map("payments")
}

enum PaymentStatus {
  PANDING
  PAID
}

enum UserRole {
  admin
  customer
}

enum Status {
  pending
  shipped
  delivered
}

enum OrderType {
  cashOnDelivery
  cash
}
